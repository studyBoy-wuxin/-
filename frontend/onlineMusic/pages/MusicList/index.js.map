{"version":3,"file":"pages/MusicList/index.js","sources":["webpack:///._src_pages_MusicList_index.tsx","webpack:///._src_pages_MusicList_index.sass","webpack:///./src/pages/MusicList/index.tsx?79ab"],"sourcesContent":["import {FC, useState} from \"react\";\r\nimport {Text, View} from \"@tarojs/components\";\r\nimport Taro from \"@tarojs/taro\";\r\nimport {AtMessage,AtActivityIndicator} from \"taro-ui\";\r\nimport './index.sass'\r\nimport {Music} from \"../Admin\";\r\nimport {\r\n  findLoveMusicByUid,\r\n  findMusicByName\r\n} from \"../../RouteInfo\";\r\nimport NavigationBar from \"../../components/NavigationBar\";\r\nimport useDidShow = Taro.useDidShow;\r\n\r\nconst LoveMusic: FC = () => {\r\n  const [MusicList, setMusicList] = useState<Music[]>([]);\r\n  const [Type, setType] = useState('')\r\n  const [IsError, setIsError] = useState(false);\r\n\r\n  const onPlay = (music:Music)=>{\r\n    const app = Taro.getApp()\r\n    app.musicInfo = music\r\n    Taro.switchTab({url:'/pages/SongDetail/index'})\r\n  }\r\n\r\n  const getLoveMusic =async ()=>{\r\n    const userInfo = Taro.getStorageSync('userInfo')\r\n    try{\r\n      const data =await findLoveMusicByUid({uid:userInfo.uid})\r\n      console.log(data)\r\n      setMusicList(data)\r\n    }catch (e){Taro.atMessage({'message':e,'type':'error'})}\r\n  }\r\n\r\n  const getMusicByName = async (name:string)=>{\r\n    try{\r\n      const data = await findMusicByName({name})\r\n      console.log(data)\r\n      data.length===0 && setIsError(true)\r\n      setMusicList(data)\r\n    }catch (e){\r\n      setIsError(true)\r\n      Taro.atMessage({'message':e,'type':'error'})\r\n    }\r\n  }\r\n\r\n  useDidShow(()=>{\r\n    const type = Taro.getCurrentInstance().router?.params.type\r\n    type && setType(type)\r\n    if(type==='LoveMusic') getLoveMusic()\r\n    else if(type==='searchMusic') {\r\n      // 音乐查找\r\n      const name = Taro.getCurrentInstance().router?.params.name\r\n      name && getMusicByName(name as string)\r\n    }else if(type==='recent'){\r\n      const data = Taro.getStorageSync('recentPlay')\r\n      setMusicList(data)\r\n    }\r\n  })\r\n\r\n  return (\r\n    <View className='LoveMusic_box'>\r\n      <NavigationBar BarText={Type=='LoveMusic'?'收藏歌曲':Type=='searchMusic'?'搜索歌曲':Type=='recent'?'最近播放':'歌曲信息'} backIcon />\r\n      <View><AtMessage /></View>\r\n      <View className='bottom'>\r\n        <View className='bottom_header'>\r\n          <View className='iconfont icon icon-yunhang' />\r\n          <Text className='title'>播放全部</Text>\r\n          <Text>(共{MusicList?.length}首)</Text>\r\n        </View>\r\n\r\n        <View className='MusicInfo_box'>\r\n          {\r\n            MusicList && MusicList.length>0 ? MusicList?.map((item, index)=>(\r\n              <View className='MusucItem' key={item.mid} onClick={()=>onPlay(item)}>\r\n                <View>{index+1}</View>\r\n                <View className='musicInfo'>\r\n                  <Text>{item.name}</Text>\r\n                  <View className='a'><View className='iconfont iconw icon-wusunyinzhi' />{item.artist}</View>\r\n                </View>\r\n                <View className='iconfont iconb icon-yunhang' />\r\n              </View>\r\n            )):Type=='searchMusic'?\r\n              <View className='noneSong'>{IsError?'搜索失败,请重试!':<AtActivityIndicator size={60} content='正在查找中...' />}</View>:\r\n              Type=='LoveMusic'?<View className='noneSong'>暂无收藏歌曲...</View>:\r\n                Type=='recent'?<View className='noneSong'>暂无最近播放记录...</View>:''\r\n          }\r\n        </View>\r\n\r\n      </View>\r\n    </View>\r\n  )\r\n}\r\nexport default LoveMusic\r\n","// extracted by mini-css-extract-plugin","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"../../../node_modules/babel-loader/lib/index.js!./index.tsx\"\nvar config = {\"navigationStyle\":\"custom\"};\n\n\nvar inst = Page(createPageConfig(component, 'pages/MusicList/index', {root:{cn:[]}}, config || {}))\n\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AAEA;AAIA;;;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAHA;AACA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAGA;AAAA;AACA;AAJA;AAGA;AACA;AACA;AALA;AAAA;AACA;AADA;AAAA;AAAA;AAMA;AAAA;AAAA;AAAA;AACA;AAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAQA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AACA;AAHA;AAEA;AACA;AACA;AACA;AALA;AAAA;AACA;AADA;AAAA;AAAA;AAOA;AACA;AAAA;AAAA;AAAA;AACA;AATA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAWA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAHA;AAKA;AACA;AACA;AAXA;AAcA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAHA;AAMA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAFA;AAIA;AAAA;AANA;AADA;AAUA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAdA;AAPA;AAHA;AA/CA;AACA;AA8EA;;;;;;;;;;;AC5FA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;A","sourceRoot":""}